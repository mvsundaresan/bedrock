{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red111\green90\blue30;\red247\green247\blue247;\red27\green27\blue27;
\red20\green0\blue196;\red181\green0\blue19;\red151\green0\blue126;\red13\green100\blue1;\red73\green17\blue135;
\red0\green0\blue0;}
{\*\expandedcolortbl;;\cssrgb\c51373\c42353\c15686;\cssrgb\c97647\c97647\c97647;\cssrgb\c14118\c14118\c14118;
\cssrgb\c10980\c0\c81176;\cssrgb\c76863\c10196\c8627;\cssrgb\c66667\c5098\c56863;\cssrgb\c0\c45490\c0;\cssrgb\c36078\c14902\c60000;
\cssrgb\c0\c0\c0;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs28 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 openapi:\cf4 \strokec4  \cf5 \strokec5 3.0.0\cf4 \strokec4 \
\cf2 \strokec2 info:\cf4 \strokec4 \
 \cf2 \strokec2 title:\cf4 \strokec4  \cf6 \strokec6 Time\cf4 \strokec4  \cf6 \strokec6 API\cf4 \strokec4 \
 \cf2 \strokec2 version:\cf4 \strokec4  \cf5 \strokec5 1.0.0\cf4 \strokec4 \
 \cf2 \strokec2 description:\cf4 \strokec4  \cf6 \strokec6 API\cf4 \strokec4  \cf6 \strokec6 to\cf4 \strokec4  \cf6 \strokec6 get\cf4 \strokec4  \cf6 \strokec6 the\cf4 \strokec4  \cf6 \strokec6 temperature\cf4 \strokec4  \cf6 \strokec6 information\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf6 \strokec6 a\cf4 \strokec4  \cf6 \strokec6 city.\cf4 \strokec4 \
\cf2 \strokec2 paths:\cf4 \strokec4 \
 \cf6 \strokec6 /get-weather-info:\cf4 \strokec4 \
 \cf2 \strokec2 get:\cf4 \strokec4 \
 \cf2 \strokec2 summary:\cf4 \strokec4  \cf6 \strokec6 Get\cf4 \strokec4  \cf6 \strokec6 the\cf4 \strokec4  \cf6 \strokec6 temperature\cf4 \strokec4  \cf6 \strokec6 information\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf6 \strokec6 a\cf4 \strokec4  \cf6 \strokec6 city.\cf4 \strokec4 \
 \cf2 \strokec2 description:\cf4 \strokec4  \cf6 \strokec6 Retrieve\cf4 \strokec4  \cf6 \strokec6 the\cf4 \strokec4  \cf6 \strokec6 temperature\cf4 \strokec4  \cf6 \strokec6 information\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf6 \strokec6 a\cf4 \strokec4  \cf6 \strokec6 city.\cf4 \strokec4 \
 \cf2 \strokec2 operationId:\cf4 \strokec4  \cf6 \strokec6 get-weather-info\cf4 \strokec4 \
 \cf2 \strokec2 parameters:\cf4 \strokec4 \
 \cf5 \strokec5 -\cf4 \strokec4  \cf2 \strokec2 name:\cf4 \strokec4  \cf6 \strokec6 city\cf4 \strokec4 \
 \cf2 \strokec2 in:\cf4 \strokec4  \cf6 \strokec6 query\cf4 \strokec4 \
 \cf2 \strokec2 description:\cf4 \strokec4  \cf6 \strokec6 The\cf4 \strokec4  \cf6 \strokec6 name\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf6 \strokec6 the\cf4 \strokec4  \cf6 \strokec6 city\cf4 \strokec4  \cf6 \strokec6 for\cf4 \strokec4  \cf6 \strokec6 which\cf4 \strokec4  \cf6 \strokec6 temperature\cf4 \strokec4  \cf6 \strokec6 information\cf4 \strokec4  \cf6 \strokec6 is\cf4 \strokec4  \cf6 \strokec6 needed.\cf4 \strokec4 \
 \cf2 \strokec2 required:\cf4 \strokec4  \cf7 \strokec7 true\cf4 \strokec4 \
 \cf2 \strokec2 schema:\cf4 \strokec4 \
 \cf2 \strokec2 type:\cf4 \strokec4  \cf6 \strokec6 string\cf4 \strokec4 \
 \cf2 \strokec2 responses:\cf4 \strokec4 \
 \cf2 \strokec2 '200':\cf4 \strokec4 \
 \cf2 \strokec2 description:\cf4 \strokec4  \cf6 \strokec6 Successful\cf4 \strokec4  \cf6 \strokec6 response\cf4 \strokec4  \cf6 \strokec6 containing\cf4 \strokec4  \cf6 \strokec6 the\cf4 \strokec4  \cf6 \strokec6 temperature\cf4 \strokec4  \cf6 \strokec6 information.\cf4 \strokec4 \
 \cf2 \strokec2 content:\cf4 \strokec4 \
 \cf2 \strokec2 application/json:\cf4 \strokec4 \
 \cf2 \strokec2 schema:\cf4 \strokec4 \
 \cf2 \strokec2 type:\cf4 \strokec4  \cf6 \strokec6 object\cf4 \strokec4 \
 \cf2 \strokec2 properties:\cf4 \strokec4 \
 \cf2 \strokec2 temperature:\cf4 \strokec4 \
 \cf2 \strokec2 type:\cf4 \strokec4  \cf6 \strokec6 string\cf4 \strokec4 \
 \cf2 \strokec2 description:\cf4 \strokec4  \cf6 \strokec6 The\cf4 \strokec4  \cf6 \strokec6 current\cf4 \strokec4  \cf6 \strokec6 temperature\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf6 \strokec6 the\cf4 \strokec4  \cf6 \strokec6 city.\
\
\
\
\pard\pardeftab720\partightenfactor0
\cf7 \strokec7 import\cf4 \strokec4  datetime\
\cf7 \strokec7 import\cf4 \strokec4  json\
\cf7 \strokec7 import\cf4 \strokec4  sys\
\cf7 \strokec7 import\cf4 \strokec4  subprocess\
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 # This is a work around to install the requests package\cf4 \cb3 \strokec4 \
\cf8 \cb3 \strokec8 # Ideally we should create a layer and add the packages through the lambda layer\cf4 \cb3 \strokec4 \
subprocess.call(\cf6 \strokec6 'pip install requests -t /tmp/ --no-cache-dir'\cf4 \strokec4 .split(), stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)\
sys.path.insert(\cf5 \strokec5 1\cf4 \strokec4 , \cf6 \strokec6 '/tmp/'\cf4 \strokec4 )\
\
\pard\pardeftab720\partightenfactor0
\cf7 \strokec7 import\cf4 \strokec4  requests\
\
\
\cf7 \strokec7 def\cf4 \strokec4  lambda_handler(\cf9 \cb3 \strokec9 event,context\cf4 \cb3 \strokec4 ):\
    \
    \cf9 \cb3 \strokec9 print\cf4 \cb3 \strokec4 (\cf6 \strokec6 "event "\cf4 \strokec4 , event)\
    apiPath = event[\cf6 \strokec6 "apiPath"\cf4 \strokec4 ]\
    city = event[\cf6 \strokec6 "parameters"\cf4 \strokec4 ][\cf5 \strokec5 0\cf4 \strokec4 ][\cf6 \strokec6 "value"\cf4 \strokec4 ]\
    \cf8 \cb3 \strokec8 # Mocking up an api using wiremockup\cf4 \cb3 \strokec4 \
    api_url = \cf6 \strokec6 f"https://r76vm.wiremockapi.cloud\cf6 \cb3 \strokec10 \{apiPath\}\cf6 \cb3 \strokec6 /\cf6 \cb3 \strokec10 \{city\}\cf6 \cb3 \strokec6 "\cf4 \strokec4 \
    \
    response_str = requests.get(api_url).text\
    response_json = \{\cf6 \strokec6 "temperature"\cf4 \strokec4 : \cf9 \cb3 \strokec9 str\cf4 \cb3 \strokec4 (response_str)\}\
    response_body = \{\cf6 \strokec6 "application/json"\cf4 \strokec4 : \{\cf6 \strokec6 "body"\cf4 \strokec4 : json.dumps(response_json)\}\}\
\
    action_response = \{\
        \cf6 \strokec6 "actionGroup"\cf4 \strokec4 : event[\cf6 \strokec6 "actionGroup"\cf4 \strokec4 ],\
        \cf6 \strokec6 "apiPath"\cf4 \strokec4 : event[\cf6 \strokec6 "apiPath"\cf4 \strokec4 ],\
        \cf6 \strokec6 "httpMethod"\cf4 \strokec4 : event[\cf6 \strokec6 "httpMethod"\cf4 \strokec4 ],\
        \cf6 \strokec6 "parameters"\cf4 \strokec4 : event[\cf6 \strokec6 "parameters"\cf4 \strokec4 ],\
        \cf6 \strokec6 "httpStatusCode"\cf4 \strokec4 : \cf5 \strokec5 200\cf4 \strokec4 ,\
        \cf6 \strokec6 "responseBody"\cf4 \strokec4 : response_body,\
    \}\
\
    session_attributes = event[\cf6 \strokec6 "sessionAttributes"\cf4 \strokec4 ]\
    prompt_session_attributes = event[\cf6 \strokec6 "promptSessionAttributes"\cf4 \strokec4 ]\
\
    \cf7 \strokec7 return\cf4 \strokec4  \{\
        \cf6 \strokec6 "messageVersion"\cf4 \strokec4 : \cf6 \strokec6 "1.0"\cf4 \strokec4 ,\
        \cf6 \strokec6 "response"\cf4 \strokec4 : action_response,\
        \cf6 \strokec6 "sessionAttributes"\cf4 \strokec4 : session_attributes,\
        \cf6 \strokec6 "promptSessionAttributes"\cf4 \strokec4 : prompt_session_attributes,\
    \}\
\
\
}